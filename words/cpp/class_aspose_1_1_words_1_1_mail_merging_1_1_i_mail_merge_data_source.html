<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"[]>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<meta name="description" content="Implement this interface to allow mail merge from a custom data source, such as a list of objects. Master-detail data is also supported."/>
<meta property="og:title" content="Aspose.Words for C++ API Reference: Aspose::Words::MailMerging::IMailMergeDataSource Interface Reference"/>
<meta property="og:type" content="website"/>
<meta property="og:description" content="Implement this interface to allow mail merge from a custom data source, such as a list of objects. Master-detail data is also supported."/>
<meta property="og:url" content="https://apireference.aspose.com/words/cpp/class/aspose.words.mail_merging.i_mail_merge_data_source"/>
<meta property="og:image" content="https://www.aspose.com/templates/aspose/App_Themes/V3/images/words/272x272/aspose_words-for-cpp.png"/>
<meta property="og:image:alt" content="Aspose.Words for C++ Logo"/>
<title>Aspose.Words for C++ API Reference: Aspose::Words::MailMerging::IMailMergeDataSource Interface Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Aspose.Words for C++ API Reference
   &#160;<span id="projectnumber">21.11</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('class_aspose_1_1_words_1_1_mail_merging_1_1_i_mail_merge_data_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="class_aspose_1_1_words_1_1_mail_merging_1_1_i_mail_merge_data_source-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Aspose::Words::MailMerging::IMailMergeDataSource Interface Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details" href=""></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implement this interface to allow mail merge from a custom data source, such as a list of objects. Master-detail data is also supported. </p>
<p>When a data source is created, it should be initialized to point to BOF (before the first record). The Aspose.Words mail merge engine will invoke <a class="el" href="class_aspose_1_1_words_1_1_mail_merging_1_1_i_mail_merge_data_source.html#movenext">MoveNext</a> to advance to next record and then invoke <a class="el" href="class_aspose_1_1_words_1_1_mail_merging_1_1_i_mail_merge_data_source.html#getvalue_string_object">GetValue()</a> for every merge field it encounters in the document or the current mail merge region.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="class_aspose_1_1_words_1_1_mail_merging_1_1_mail_merge.html" title="Represents the mail merge functionality.">Aspose::Words::MailMerging::MailMerge</a></dd></dl>
<dl class="section user"><dt>Examples</dt><dd></dd></dl>
<p>Shows how to execute a mail merge with a data source in the form of a custom object. </p><div class="fragment" data-nosnippet=""><div class="line"><span class="keywordtype">void</span> CustomDataSource()</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">auto</span> doc = MakeObject&lt;Document&gt;();</div>
<div class="line">    <span class="keyword">auto</span> builder = MakeObject&lt;DocumentBuilder&gt;(doc);</div>
<div class="line">    builder-&gt;InsertField(u<span class="stringliteral">" MERGEFIELD FullName "</span>);</div>
<div class="line">    builder-&gt;InsertParagraph();</div>
<div class="line">    builder-&gt;InsertField(u<span class="stringliteral">" MERGEFIELD Address "</span>);</div>
<div class="line"> </div>
<div class="line">    SharedPtr&lt;System::Collections::Generic::List&lt;SharedPtr&lt;ExMailMergeCustom::Customer&gt;&gt;&gt; customers =</div>
<div class="line">        MakeObject&lt;System::Collections::Generic::List&lt;SharedPtr&lt;ExMailMergeCustom::Customer&gt;&gt;&gt;();</div>
<div class="line">    customers-&gt;Add(MakeObject&lt;ExMailMergeCustom::Customer&gt;(u<span class="stringliteral">"Thomas Hardy"</span>, u<span class="stringliteral">"120 Hanover Sq., London"</span>));</div>
<div class="line">    customers-&gt;Add(MakeObject&lt;ExMailMergeCustom::Customer&gt;(u<span class="stringliteral">"Paolo Accorti"</span>, u<span class="stringliteral">"Via Monte Bianco 34, Torino"</span>));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// To use a custom object as a data source, it must implement the IMailMergeDataSource interface.</span></div>
<div class="line">    <span class="keyword">auto</span> dataSource = MakeObject&lt;ExMailMergeCustom::CustomerMailMergeDataSource&gt;(customers);</div>
<div class="line"> </div>
<div class="line">    doc-&gt;get_MailMerge()-&gt;Execute(dataSource);</div>
<div class="line"> </div>
<div class="line">    doc-&gt;Save(ArtifactsDir + u<span class="stringliteral">"MailMergeCustom.CustomDataSource.docx"</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>Customer : <span class="keyword">public</span> <a class="codeRef" target="_blank" href="https://apireference.codeporting.com/native/cs2cpp/class/system.object/">System::Object</a></div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    String get_FullName()</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> pr_FullName;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> set_FullName(String value)</div>
<div class="line">    {</div>
<div class="line">        pr_FullName = value;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    String get_Address()</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> pr_Address;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> set_Address(String value)</div>
<div class="line">    {</div>
<div class="line">        pr_Address = value;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    Customer(String aFullName, String anAddress)</div>
<div class="line">    {</div>
<div class="line">        set_FullName(aFullName);</div>
<div class="line">        set_Address(anAddress);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    String pr_FullName;</div>
<div class="line">    String pr_Address;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>CustomerMailMergeDataSource : <span class="keyword">public</span> IMailMergeDataSource</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    String <a class="code" href="class_aspose_1_1_words_1_1_mail_merging_1_1_i_mail_merge_data_source.html#get_tablename" title="Returns the name of the data source.">get_TableName</a>()<span class="keyword"> override</span></div>
<div class="line"><span class="keyword">    </span>{</div>
<div class="line">        <span class="keywordflow">return</span> u<span class="stringliteral">"Customer"</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    CustomerMailMergeDataSource(SharedPtr&lt;<a class="codeRef" target="_blank" href="https://apireference.codeporting.com/native/cs2cpp/class/system.collections.generic.list.enumerator/">System::Collections::Generic::List</a>&lt;SharedPtr&lt;ExMailMergeCustom::Customer&gt;&gt;&gt; customers) : mRecordIndex(0)</div>
<div class="line">    {</div>
<div class="line">        mCustomers = customers;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// When we initialize the data source, its position must be before the first record.</span></div>
<div class="line">        mRecordIndex = -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">bool</span> <a class="code" href="class_aspose_1_1_words_1_1_mail_merging_1_1_i_mail_merge_data_source.html#getvalue_string_object">GetValue</a>(String fieldName, SharedPtr&lt;System::Object&gt;&amp; fieldValue)<span class="keyword"> override</span></div>
<div class="line"><span class="keyword">    </span>{</div>
<div class="line">        <span class="keywordflow">if</span> (fieldName == u<span class="stringliteral">"FullName"</span>)</div>
<div class="line">        {</div>
<div class="line">            fieldValue = System::ObjectExt::Box&lt;String&gt;(mCustomers-&gt;idx_get(mRecordIndex)-&gt;get_FullName());</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fieldName == u<span class="stringliteral">"Address"</span>)</div>
<div class="line">        {</div>
<div class="line">            fieldValue = System::ObjectExt::Box&lt;String&gt;(mCustomers-&gt;idx_get(mRecordIndex)-&gt;get_Address());</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line">            fieldValue.reset();</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">bool</span> <a class="code" href="class_aspose_1_1_words_1_1_mail_merging_1_1_i_mail_merge_data_source.html#movenext" title="Advances to the next record in the data source.">MoveNext</a>()<span class="keyword"> override</span></div>
<div class="line"><span class="keyword">    </span>{</div>
<div class="line">        <span class="keywordflow">if</span> (!get_IsEof())</div>
<div class="line">        {</div>
<div class="line">            mRecordIndex++;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> !get_IsEof();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    SharedPtr&lt;IMailMergeDataSource&gt; <a class="code" href="class_aspose_1_1_words_1_1_mail_merging_1_1_i_mail_merge_data_source.html#getchilddatasource_string" title="The Aspose.Words mail merge engine invokes this method when it encounters a beginning of a nested mai...">GetChildDataSource</a>(String tableName)<span class="keyword"> override</span></div>
<div class="line"><span class="keyword">    </span>{</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    <span class="keywordtype">bool</span> get_IsEof()</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> mRecordIndex &gt;= mCustomers-&gt;get_Count();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    SharedPtr&lt;System::Collections::Generic::List&lt;SharedPtr&lt;ExMailMergeCustom::Customer&gt;&gt;&gt; mCustomers;</div>
<div class="line">    <span class="keywordtype">int</span> mRecordIndex;</div>
<div class="line">};</div>
</div><!-- fragment --> </div>
<p><code>#include &lt;<a class="el" href="_i_mail_merge_data_source_8h_source.html">Aspose.Words.Cpp/MailMerging/IMailMergeDataSource.h</a>&gt;</code></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Inheritance diagram for Aspose::Words::MailMerging::IMailMergeDataSource:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
 <div class="center">
  <img src="class_aspose_1_1_words_1_1_mail_merging_1_1_i_mail_merge_data_source.png" usemap="#Aspose::Words::MailMerging::IMailMergeDataSource_map" alt="Aspose::Words::MailMerging::IMailMergeDataSource"/>
  <map id="Aspose::Words::MailMerging::IMailMergeDataSource_map" name="Aspose::Words::MailMerging::IMailMergeDataSource_map">
<area target="_blank" href="https://apireference.codeporting.com/native/cs2cpp/class/system.object" alt="System::Object" shape="rect" coords="0,0,310,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods" href=""></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a520266e24cd6bd73667ebb969f3ef28f"><td class="memItemLeft" align="right" valign="top">virtual <a class="elRef" target="_blank" href="https://apireference.codeporting.com/native/cs2cpp/class/system.string/">String</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_aspose_1_1_words_1_1_mail_merging_1_1_i_mail_merge_data_source.html#get_tablename">get_TableName</a> ()=0</td></tr>
<tr class="memdesc:a520266e24cd6bd73667ebb969f3ef28f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the name of the data source.  <a href="class_aspose_1_1_words_1_1_mail_merging_1_1_i_mail_merge_data_source.html#get_tablename">More...</a><br/></td></tr>
<tr class="separator:a520266e24cd6bd73667ebb969f3ef28f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d42726de18e831f530f75b1db04a741"><td class="memItemLeft" align="right" valign="top">virtual <a class="elRef" target="_blank" href="https://apireference.codeporting.com/native/cs2cpp/namespace/system#a6b77ccd8c49df28c153be0462cdfdf49">SharedPtr</a>&lt; <a class="el" href="class_aspose_1_1_words_1_1_mail_merging_1_1_i_mail_merge_data_source.html">IMailMergeDataSource</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_aspose_1_1_words_1_1_mail_merging_1_1_i_mail_merge_data_source.html#getchilddatasource_string">GetChildDataSource</a> (<a class="elRef" target="_blank" href="https://apireference.codeporting.com/native/cs2cpp/class/system.string/">String</a> tableName)=0</td></tr>
<tr class="memdesc:a8d42726de18e831f530f75b1db04a741"><td class="mdescLeft">&#160;</td><td class="mdescRight">The Aspose.Words mail merge engine invokes this method when it encounters a beginning of a nested mail merge region.  <a href="class_aspose_1_1_words_1_1_mail_merging_1_1_i_mail_merge_data_source.html#getchilddatasource_string">More...</a><br/></td></tr>
<tr class="separator:a8d42726de18e831f530f75b1db04a741"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af90ef85703cee56f493eb452a72f2fdc"><td class="memItemLeft" align="right" valign="top">virtual const <a class="elRef" target="_blank" href="https://apireference.codeporting.com/native/cs2cpp/class/system.type_info/">TypeInfo</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_aspose_1_1_words_1_1_mail_merging_1_1_i_mail_merge_data_source.html#gettype_const">GetType</a> () const override</td></tr>
<tr class="separator:af90ef85703cee56f493eb452a72f2fdc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9efaf060a21a43408e19fff932e9e47d"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_aspose_1_1_words_1_1_mail_merging_1_1_i_mail_merge_data_source.html#getvalue_string_object">GetValue</a> (<a class="elRef" target="_blank" href="https://apireference.codeporting.com/native/cs2cpp/class/system.string/">String</a> fieldName, <a class="elRef" target="_blank" href="https://apireference.codeporting.com/native/cs2cpp/namespace/system#a6b77ccd8c49df28c153be0462cdfdf49">SharedPtr</a>&lt; <a class="elRef" target="_blank" href="https://apireference.codeporting.com/native/cs2cpp/class/system.object/">Object</a> &gt; &amp;fieldValue)=0</td></tr>
<tr class="separator:a9efaf060a21a43408e19fff932e9e47d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9bd172a4b3392f5087ad05ec25646845"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_aspose_1_1_words_1_1_mail_merging_1_1_i_mail_merge_data_source.html#is_typeinfo_const">Is</a> (const <a class="elRef" target="_blank" href="https://apireference.codeporting.com/native/cs2cpp/class/system.type_info/">TypeInfo</a> &amp;target) const override</td></tr>
<tr class="separator:a9bd172a4b3392f5087ad05ec25646845"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bfd50d436a16e1ac6a15bbfd443e50d"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_aspose_1_1_words_1_1_mail_merging_1_1_i_mail_merge_data_source.html#movenext">MoveNext</a> ()=0</td></tr>
<tr class="memdesc:a0bfd50d436a16e1ac6a15bbfd443e50d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Advances to the next record in the data source.  <a href="class_aspose_1_1_words_1_1_mail_merging_1_1_i_mail_merge_data_source.html#movenext">More...</a><br/></td></tr>
<tr class="separator:a0bfd50d436a16e1ac6a15bbfd443e50d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods" href=""></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:ac5eef073896dd142c677b8413e603803"><td class="memItemLeft" align="right" valign="top">static const <a class="elRef" target="_blank" href="https://apireference.codeporting.com/native/cs2cpp/class/system.type_info/">TypeInfo</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_aspose_1_1_words_1_1_mail_merging_1_1_i_mail_merge_data_source.html#type">Type</a> ()</td></tr>
<tr class="separator:ac5eef073896dd142c677b8413e603803"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a520266e24cd6bd73667ebb969f3ef28f" href=""></a><a id="get_tablename" href=""></a>
<h2 class="memtitle"><span class="permalink"><a href="#get_tablename">&#9670;&#160;</a></span>get_TableName()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="elRef" target="_blank" href="https://apireference.codeporting.com/native/cs2cpp/class/system.string/">System::String</a> Aspose::Words::MailMerging::IMailMergeDataSource::get_TableName </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the name of the data source. </p>
<p>If you are implementing <a class="el" href="class_aspose_1_1_words_1_1_mail_merging_1_1_i_mail_merge_data_source.html">IMailMergeDataSource</a>, return the name of the data source from this property.</p>
<p>Aspose.Words uses this name to match against the mail merge region name specified in the template document. The comparison between the data source name and the mail merge region name is not case sensitive.</p>
<dl class="section return"><dt>Returns</dt><dd>The name of the data source. Empty string if the data source has no name.</dd></dl>
<dl class="section user"><dt>Examples</dt><dd></dd></dl>
<p>Shows how to execute a mail merge with a data source in the form of a custom object. </p><div class="fragment" data-nosnippet=""><div class="line"><span class="keywordtype">void</span> CustomDataSource()</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">auto</span> doc = MakeObject&lt;Document&gt;();</div>
<div class="line">    <span class="keyword">auto</span> builder = MakeObject&lt;DocumentBuilder&gt;(doc);</div>
<div class="line">    builder-&gt;InsertField(u<span class="stringliteral">" MERGEFIELD FullName "</span>);</div>
<div class="line">    builder-&gt;InsertParagraph();</div>
<div class="line">    builder-&gt;InsertField(u<span class="stringliteral">" MERGEFIELD Address "</span>);</div>
<div class="line"> </div>
<div class="line">    SharedPtr&lt;System::Collections::Generic::List&lt;SharedPtr&lt;ExMailMergeCustom::Customer&gt;&gt;&gt; customers =</div>
<div class="line">        MakeObject&lt;System::Collections::Generic::List&lt;SharedPtr&lt;ExMailMergeCustom::Customer&gt;&gt;&gt;();</div>
<div class="line">    customers-&gt;Add(MakeObject&lt;ExMailMergeCustom::Customer&gt;(u<span class="stringliteral">"Thomas Hardy"</span>, u<span class="stringliteral">"120 Hanover Sq., London"</span>));</div>
<div class="line">    customers-&gt;Add(MakeObject&lt;ExMailMergeCustom::Customer&gt;(u<span class="stringliteral">"Paolo Accorti"</span>, u<span class="stringliteral">"Via Monte Bianco 34, Torino"</span>));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// To use a custom object as a data source, it must implement the IMailMergeDataSource interface.</span></div>
<div class="line">    <span class="keyword">auto</span> dataSource = MakeObject&lt;ExMailMergeCustom::CustomerMailMergeDataSource&gt;(customers);</div>
<div class="line"> </div>
<div class="line">    doc-&gt;get_MailMerge()-&gt;Execute(dataSource);</div>
<div class="line"> </div>
<div class="line">    doc-&gt;Save(ArtifactsDir + u<span class="stringliteral">"MailMergeCustom.CustomDataSource.docx"</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>Customer : <span class="keyword">public</span> <a class="codeRef" target="_blank" href="https://apireference.codeporting.com/native/cs2cpp/class/system.object/">System::Object</a></div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    String get_FullName()</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> pr_FullName;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> set_FullName(String value)</div>
<div class="line">    {</div>
<div class="line">        pr_FullName = value;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    String get_Address()</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> pr_Address;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> set_Address(String value)</div>
<div class="line">    {</div>
<div class="line">        pr_Address = value;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    Customer(String aFullName, String anAddress)</div>
<div class="line">    {</div>
<div class="line">        set_FullName(aFullName);</div>
<div class="line">        set_Address(anAddress);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    String pr_FullName;</div>
<div class="line">    String pr_Address;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>CustomerMailMergeDataSource : <span class="keyword">public</span> IMailMergeDataSource</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    String <a class="code" href="class_aspose_1_1_words_1_1_mail_merging_1_1_i_mail_merge_data_source.html#get_tablename" title="Returns the name of the data source.">get_TableName</a>()<span class="keyword"> override</span></div>
<div class="line"><span class="keyword">    </span>{</div>
<div class="line">        <span class="keywordflow">return</span> u<span class="stringliteral">"Customer"</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    CustomerMailMergeDataSource(SharedPtr&lt;<a class="codeRef" target="_blank" href="https://apireference.codeporting.com/native/cs2cpp/class/system.collections.generic.list.enumerator/">System::Collections::Generic::List</a>&lt;SharedPtr&lt;ExMailMergeCustom::Customer&gt;&gt;&gt; customers) : mRecordIndex(0)</div>
<div class="line">    {</div>
<div class="line">        mCustomers = customers;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// When we initialize the data source, its position must be before the first record.</span></div>
<div class="line">        mRecordIndex = -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">bool</span> <a class="code" href="class_aspose_1_1_words_1_1_mail_merging_1_1_i_mail_merge_data_source.html#getvalue_string_object">GetValue</a>(String fieldName, SharedPtr&lt;System::Object&gt;&amp; fieldValue)<span class="keyword"> override</span></div>
<div class="line"><span class="keyword">    </span>{</div>
<div class="line">        <span class="keywordflow">if</span> (fieldName == u<span class="stringliteral">"FullName"</span>)</div>
<div class="line">        {</div>
<div class="line">            fieldValue = System::ObjectExt::Box&lt;String&gt;(mCustomers-&gt;idx_get(mRecordIndex)-&gt;get_FullName());</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fieldName == u<span class="stringliteral">"Address"</span>)</div>
<div class="line">        {</div>
<div class="line">            fieldValue = System::ObjectExt::Box&lt;String&gt;(mCustomers-&gt;idx_get(mRecordIndex)-&gt;get_Address());</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line">            fieldValue.reset();</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">bool</span> <a class="code" href="class_aspose_1_1_words_1_1_mail_merging_1_1_i_mail_merge_data_source.html#movenext" title="Advances to the next record in the data source.">MoveNext</a>()<span class="keyword"> override</span></div>
<div class="line"><span class="keyword">    </span>{</div>
<div class="line">        <span class="keywordflow">if</span> (!get_IsEof())</div>
<div class="line">        {</div>
<div class="line">            mRecordIndex++;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> !get_IsEof();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    SharedPtr&lt;IMailMergeDataSource&gt; <a class="code" href="class_aspose_1_1_words_1_1_mail_merging_1_1_i_mail_merge_data_source.html#getchilddatasource_string" title="The Aspose.Words mail merge engine invokes this method when it encounters a beginning of a nested mai...">GetChildDataSource</a>(String tableName)<span class="keyword"> override</span></div>
<div class="line"><span class="keyword">    </span>{</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    <span class="keywordtype">bool</span> get_IsEof()</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> mRecordIndex &gt;= mCustomers-&gt;get_Count();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    SharedPtr&lt;System::Collections::Generic::List&lt;SharedPtr&lt;ExMailMergeCustom::Customer&gt;&gt;&gt; mCustomers;</div>
<div class="line">    <span class="keywordtype">int</span> mRecordIndex;</div>
<div class="line">};</div>
</div><!-- fragment --> 
</div>
</div>
<a id="a8d42726de18e831f530f75b1db04a741" href=""></a><a id="getchilddatasource_string" href=""></a>
<h2 class="memtitle"><span class="permalink"><a href="#getchilddatasource_string">&#9670;&#160;</a></span>GetChildDataSource()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="elRef" target="_blank" href="https://apireference.codeporting.com/native/cs2cpp/namespace/system#a6b77ccd8c49df28c153be0462cdfdf49">System::SharedPtr</a>&lt;<a class="el" href="class_aspose_1_1_words_1_1_mail_merging_1_1_i_mail_merge_data_source.html">Aspose::Words::MailMerging::IMailMergeDataSource</a>&gt; Aspose::Words::MailMerging::IMailMergeDataSource::GetChildDataSource </td>
          <td>(</td>
          <td class="paramtype"><a class="elRef" target="_blank" href="https://apireference.codeporting.com/native/cs2cpp/class/system.string/">System::String</a>&#160;</td>
          <td class="paramname"><em>tableName</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The Aspose.Words mail merge engine invokes this method when it encounters a beginning of a nested mail merge region. </p>
<p>When the Aspose.Words mail merge engines populates a mail merge region with data and encounters the beginning of a nested mail merge region in the form of MERGEFIELD TableStart:TableName, it invokes <a class="el" href="class_aspose_1_1_words_1_1_mail_merging_1_1_i_mail_merge_data_source.html#getchilddatasource_string">GetChildDataSource()</a> on the current data source object. Your implementation needs to return a new data source object that will provide access to the child records of the current parent record. Aspose.Words will use the returned data source to populate the nested mail merge region.</p>
<p>Below are the rules that the implementation of <a class="el" href="class_aspose_1_1_words_1_1_mail_merging_1_1_i_mail_merge_data_source.html#getchilddatasource_string">GetChildDataSource()</a> must follow.</p>
<p>If the table that is represented by this data source object has a related child (detail) table with the specified name, then your implementation needs to return a new <a class="el" href="class_aspose_1_1_words_1_1_mail_merging_1_1_i_mail_merge_data_source.html">IMailMergeDataSource</a> object that will provide access to the child records of the current record. An example of this is Orders / OrderDetails relationship. Let's assume that the current <a class="el" href="class_aspose_1_1_words_1_1_mail_merging_1_1_i_mail_merge_data_source.html">IMailMergeDataSource</a> object represents the Orders table and it has a current order record. Next, Aspose.Words encounters "MERGEFIELD TableStart:OrderDetails" in the document and invokes <a class="el" href="class_aspose_1_1_words_1_1_mail_merging_1_1_i_mail_merge_data_source.html#getchilddatasource_string">GetChildDataSource()</a>. You need to create and return a <a class="el" href="class_aspose_1_1_words_1_1_mail_merging_1_1_i_mail_merge_data_source.html">IMailMergeDataSource</a> object that will allow Aspose.Words to access the OrderDetails record for the current order.</p>
<p>If this data source object does not have a relation to the table with the specified name, then you need to return a <a class="el" href="class_aspose_1_1_words_1_1_mail_merging_1_1_i_mail_merge_data_source.html">IMailMergeDataSource</a> object that will provide access to all records of the specified table.</p>
<p>If a table with the specified name does not exist, your implementation should return <code>null</code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tableName</td><td>The name of the mail merge region as specified in the template document. Case-insensitive.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A data source object that will provide access to the data records of the specified table.</dd></dl>
<dl class="section user"><dt>Examples</dt><dd></dd></dl>
<p>Shows how to execute a mail merge with a data source in the form of a custom object. </p><div class="fragment" data-nosnippet=""><div class="line"><span class="keywordtype">void</span> CustomDataSource()</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">auto</span> doc = MakeObject&lt;Document&gt;();</div>
<div class="line">    <span class="keyword">auto</span> builder = MakeObject&lt;DocumentBuilder&gt;(doc);</div>
<div class="line">    builder-&gt;InsertField(u<span class="stringliteral">" MERGEFIELD FullName "</span>);</div>
<div class="line">    builder-&gt;InsertParagraph();</div>
<div class="line">    builder-&gt;InsertField(u<span class="stringliteral">" MERGEFIELD Address "</span>);</div>
<div class="line"> </div>
<div class="line">    SharedPtr&lt;System::Collections::Generic::List&lt;SharedPtr&lt;ExMailMergeCustom::Customer&gt;&gt;&gt; customers =</div>
<div class="line">        MakeObject&lt;System::Collections::Generic::List&lt;SharedPtr&lt;ExMailMergeCustom::Customer&gt;&gt;&gt;();</div>
<div class="line">    customers-&gt;Add(MakeObject&lt;ExMailMergeCustom::Customer&gt;(u<span class="stringliteral">"Thomas Hardy"</span>, u<span class="stringliteral">"120 Hanover Sq., London"</span>));</div>
<div class="line">    customers-&gt;Add(MakeObject&lt;ExMailMergeCustom::Customer&gt;(u<span class="stringliteral">"Paolo Accorti"</span>, u<span class="stringliteral">"Via Monte Bianco 34, Torino"</span>));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// To use a custom object as a data source, it must implement the IMailMergeDataSource interface.</span></div>
<div class="line">    <span class="keyword">auto</span> dataSource = MakeObject&lt;ExMailMergeCustom::CustomerMailMergeDataSource&gt;(customers);</div>
<div class="line"> </div>
<div class="line">    doc-&gt;get_MailMerge()-&gt;Execute(dataSource);</div>
<div class="line"> </div>
<div class="line">    doc-&gt;Save(ArtifactsDir + u<span class="stringliteral">"MailMergeCustom.CustomDataSource.docx"</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>Customer : <span class="keyword">public</span> <a class="codeRef" target="_blank" href="https://apireference.codeporting.com/native/cs2cpp/class/system.object/">System::Object</a></div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    String get_FullName()</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> pr_FullName;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> set_FullName(String value)</div>
<div class="line">    {</div>
<div class="line">        pr_FullName = value;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    String get_Address()</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> pr_Address;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> set_Address(String value)</div>
<div class="line">    {</div>
<div class="line">        pr_Address = value;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    Customer(String aFullName, String anAddress)</div>
<div class="line">    {</div>
<div class="line">        set_FullName(aFullName);</div>
<div class="line">        set_Address(anAddress);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    String pr_FullName;</div>
<div class="line">    String pr_Address;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>CustomerMailMergeDataSource : <span class="keyword">public</span> IMailMergeDataSource</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    String <a class="code" href="class_aspose_1_1_words_1_1_mail_merging_1_1_i_mail_merge_data_source.html#get_tablename" title="Returns the name of the data source.">get_TableName</a>()<span class="keyword"> override</span></div>
<div class="line"><span class="keyword">    </span>{</div>
<div class="line">        <span class="keywordflow">return</span> u<span class="stringliteral">"Customer"</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    CustomerMailMergeDataSource(SharedPtr&lt;<a class="codeRef" target="_blank" href="https://apireference.codeporting.com/native/cs2cpp/class/system.collections.generic.list.enumerator/">System::Collections::Generic::List</a>&lt;SharedPtr&lt;ExMailMergeCustom::Customer&gt;&gt;&gt; customers) : mRecordIndex(0)</div>
<div class="line">    {</div>
<div class="line">        mCustomers = customers;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// When we initialize the data source, its position must be before the first record.</span></div>
<div class="line">        mRecordIndex = -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">bool</span> <a class="code" href="class_aspose_1_1_words_1_1_mail_merging_1_1_i_mail_merge_data_source.html#getvalue_string_object">GetValue</a>(String fieldName, SharedPtr&lt;System::Object&gt;&amp; fieldValue)<span class="keyword"> override</span></div>
<div class="line"><span class="keyword">    </span>{</div>
<div class="line">        <span class="keywordflow">if</span> (fieldName == u<span class="stringliteral">"FullName"</span>)</div>
<div class="line">        {</div>
<div class="line">            fieldValue = System::ObjectExt::Box&lt;String&gt;(mCustomers-&gt;idx_get(mRecordIndex)-&gt;get_FullName());</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fieldName == u<span class="stringliteral">"Address"</span>)</div>
<div class="line">        {</div>
<div class="line">            fieldValue = System::ObjectExt::Box&lt;String&gt;(mCustomers-&gt;idx_get(mRecordIndex)-&gt;get_Address());</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line">            fieldValue.reset();</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">bool</span> <a class="code" href="class_aspose_1_1_words_1_1_mail_merging_1_1_i_mail_merge_data_source.html#movenext" title="Advances to the next record in the data source.">MoveNext</a>()<span class="keyword"> override</span></div>
<div class="line"><span class="keyword">    </span>{</div>
<div class="line">        <span class="keywordflow">if</span> (!get_IsEof())</div>
<div class="line">        {</div>
<div class="line">            mRecordIndex++;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> !get_IsEof();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    SharedPtr&lt;IMailMergeDataSource&gt; <a class="code" href="class_aspose_1_1_words_1_1_mail_merging_1_1_i_mail_merge_data_source.html#getchilddatasource_string" title="The Aspose.Words mail merge engine invokes this method when it encounters a beginning of a nested mai...">GetChildDataSource</a>(String tableName)<span class="keyword"> override</span></div>
<div class="line"><span class="keyword">    </span>{</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    <span class="keywordtype">bool</span> get_IsEof()</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> mRecordIndex &gt;= mCustomers-&gt;get_Count();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    SharedPtr&lt;System::Collections::Generic::List&lt;SharedPtr&lt;ExMailMergeCustom::Customer&gt;&gt;&gt; mCustomers;</div>
<div class="line">    <span class="keywordtype">int</span> mRecordIndex;</div>
<div class="line">};</div>
</div><!-- fragment --> 
</div>
</div>
<a id="af90ef85703cee56f493eb452a72f2fdc" href=""></a><a id="gettype_const" href=""></a>
<h2 class="memtitle"><span class="permalink"><a href="#gettype_const">&#9670;&#160;</a></span>GetType()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual const <a class="elRef" target="_blank" href="https://apireference.codeporting.com/native/cs2cpp/class/system.type_info/">System::TypeInfo</a>&amp; Aspose::Words::MailMerging::IMailMergeDataSource::GetType </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reimplemented from <a class="elRef" target="_blank" href="https://apireference.codeporting.com/native/cs2cpp/class/system.object/#ab108566dd35d8621466bbac2a40bd452">System::Object</a>.</p>

</div>
</div>
<a id="a9efaf060a21a43408e19fff932e9e47d" href=""></a><a id="getvalue_string_object" href=""></a>
<h2 class="memtitle"><span class="permalink"><a href="#getvalue_string_object">&#9670;&#160;</a></span>GetValue()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool Aspose::Words::MailMerging::IMailMergeDataSource::GetValue </td>
          <td>(</td>
          <td class="paramtype"><a class="elRef" target="_blank" href="https://apireference.codeporting.com/native/cs2cpp/class/system.string/">System::String</a>&#160;</td>
          <td class="paramname"><em>fieldName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" target="_blank" href="https://apireference.codeporting.com/native/cs2cpp/namespace/system#a6b77ccd8c49df28c153be0462cdfdf49">System::SharedPtr</a>&lt; <a class="elRef" target="_blank" href="https://apireference.codeporting.com/native/cs2cpp/class/system.object/">System::Object</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>fieldValue</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a9bd172a4b3392f5087ad05ec25646845" href=""></a><a id="is_typeinfo_const" href=""></a>
<h2 class="memtitle"><span class="permalink"><a href="#is_typeinfo_const">&#9670;&#160;</a></span>Is()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool Aspose::Words::MailMerging::IMailMergeDataSource::Is </td>
          <td>(</td>
          <td class="paramtype">const <a class="elRef" target="_blank" href="https://apireference.codeporting.com/native/cs2cpp/class/system.type_info/">System::TypeInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>target</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reimplemented from <a class="elRef" target="_blank" href="https://apireference.codeporting.com/native/cs2cpp/class/system.object/#a126ddfe162038b96570fe3a4871a3060">System::Object</a>.</p>

</div>
</div>
<a id="a0bfd50d436a16e1ac6a15bbfd443e50d" href=""></a><a id="movenext" href=""></a>
<h2 class="memtitle"><span class="permalink"><a href="#movenext">&#9670;&#160;</a></span>MoveNext()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool Aspose::Words::MailMerging::IMailMergeDataSource::MoveNext </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Advances to the next record in the data source. </p>
<dl class="section return"><dt>Returns</dt><dd>True if moved to next record successfully. False if reached end of the data source.</dd></dl>
<dl class="section user"><dt>Examples</dt><dd></dd></dl>
<p>Shows how to execute a mail merge with a data source in the form of a custom object. </p><div class="fragment" data-nosnippet=""><div class="line"><span class="keywordtype">void</span> CustomDataSource()</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">auto</span> doc = MakeObject&lt;Document&gt;();</div>
<div class="line">    <span class="keyword">auto</span> builder = MakeObject&lt;DocumentBuilder&gt;(doc);</div>
<div class="line">    builder-&gt;InsertField(u<span class="stringliteral">" MERGEFIELD FullName "</span>);</div>
<div class="line">    builder-&gt;InsertParagraph();</div>
<div class="line">    builder-&gt;InsertField(u<span class="stringliteral">" MERGEFIELD Address "</span>);</div>
<div class="line"> </div>
<div class="line">    SharedPtr&lt;System::Collections::Generic::List&lt;SharedPtr&lt;ExMailMergeCustom::Customer&gt;&gt;&gt; customers =</div>
<div class="line">        MakeObject&lt;System::Collections::Generic::List&lt;SharedPtr&lt;ExMailMergeCustom::Customer&gt;&gt;&gt;();</div>
<div class="line">    customers-&gt;Add(MakeObject&lt;ExMailMergeCustom::Customer&gt;(u<span class="stringliteral">"Thomas Hardy"</span>, u<span class="stringliteral">"120 Hanover Sq., London"</span>));</div>
<div class="line">    customers-&gt;Add(MakeObject&lt;ExMailMergeCustom::Customer&gt;(u<span class="stringliteral">"Paolo Accorti"</span>, u<span class="stringliteral">"Via Monte Bianco 34, Torino"</span>));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// To use a custom object as a data source, it must implement the IMailMergeDataSource interface.</span></div>
<div class="line">    <span class="keyword">auto</span> dataSource = MakeObject&lt;ExMailMergeCustom::CustomerMailMergeDataSource&gt;(customers);</div>
<div class="line"> </div>
<div class="line">    doc-&gt;get_MailMerge()-&gt;Execute(dataSource);</div>
<div class="line"> </div>
<div class="line">    doc-&gt;Save(ArtifactsDir + u<span class="stringliteral">"MailMergeCustom.CustomDataSource.docx"</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>Customer : <span class="keyword">public</span> <a class="codeRef" target="_blank" href="https://apireference.codeporting.com/native/cs2cpp/class/system.object/">System::Object</a></div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    String get_FullName()</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> pr_FullName;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> set_FullName(String value)</div>
<div class="line">    {</div>
<div class="line">        pr_FullName = value;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    String get_Address()</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> pr_Address;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> set_Address(String value)</div>
<div class="line">    {</div>
<div class="line">        pr_Address = value;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    Customer(String aFullName, String anAddress)</div>
<div class="line">    {</div>
<div class="line">        set_FullName(aFullName);</div>
<div class="line">        set_Address(anAddress);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    String pr_FullName;</div>
<div class="line">    String pr_Address;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>CustomerMailMergeDataSource : <span class="keyword">public</span> IMailMergeDataSource</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    String <a class="code" href="class_aspose_1_1_words_1_1_mail_merging_1_1_i_mail_merge_data_source.html#get_tablename" title="Returns the name of the data source.">get_TableName</a>()<span class="keyword"> override</span></div>
<div class="line"><span class="keyword">    </span>{</div>
<div class="line">        <span class="keywordflow">return</span> u<span class="stringliteral">"Customer"</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    CustomerMailMergeDataSource(SharedPtr&lt;<a class="codeRef" target="_blank" href="https://apireference.codeporting.com/native/cs2cpp/class/system.collections.generic.list.enumerator/">System::Collections::Generic::List</a>&lt;SharedPtr&lt;ExMailMergeCustom::Customer&gt;&gt;&gt; customers) : mRecordIndex(0)</div>
<div class="line">    {</div>
<div class="line">        mCustomers = customers;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// When we initialize the data source, its position must be before the first record.</span></div>
<div class="line">        mRecordIndex = -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">bool</span> <a class="code" href="class_aspose_1_1_words_1_1_mail_merging_1_1_i_mail_merge_data_source.html#getvalue_string_object">GetValue</a>(String fieldName, SharedPtr&lt;System::Object&gt;&amp; fieldValue)<span class="keyword"> override</span></div>
<div class="line"><span class="keyword">    </span>{</div>
<div class="line">        <span class="keywordflow">if</span> (fieldName == u<span class="stringliteral">"FullName"</span>)</div>
<div class="line">        {</div>
<div class="line">            fieldValue = System::ObjectExt::Box&lt;String&gt;(mCustomers-&gt;idx_get(mRecordIndex)-&gt;get_FullName());</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fieldName == u<span class="stringliteral">"Address"</span>)</div>
<div class="line">        {</div>
<div class="line">            fieldValue = System::ObjectExt::Box&lt;String&gt;(mCustomers-&gt;idx_get(mRecordIndex)-&gt;get_Address());</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line">            fieldValue.reset();</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">bool</span> <a class="code" href="class_aspose_1_1_words_1_1_mail_merging_1_1_i_mail_merge_data_source.html#movenext" title="Advances to the next record in the data source.">MoveNext</a>()<span class="keyword"> override</span></div>
<div class="line"><span class="keyword">    </span>{</div>
<div class="line">        <span class="keywordflow">if</span> (!get_IsEof())</div>
<div class="line">        {</div>
<div class="line">            mRecordIndex++;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> !get_IsEof();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    SharedPtr&lt;IMailMergeDataSource&gt; <a class="code" href="class_aspose_1_1_words_1_1_mail_merging_1_1_i_mail_merge_data_source.html#getchilddatasource_string" title="The Aspose.Words mail merge engine invokes this method when it encounters a beginning of a nested mai...">GetChildDataSource</a>(String tableName)<span class="keyword"> override</span></div>
<div class="line"><span class="keyword">    </span>{</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    <span class="keywordtype">bool</span> get_IsEof()</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> mRecordIndex &gt;= mCustomers-&gt;get_Count();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    SharedPtr&lt;System::Collections::Generic::List&lt;SharedPtr&lt;ExMailMergeCustom::Customer&gt;&gt;&gt; mCustomers;</div>
<div class="line">    <span class="keywordtype">int</span> mRecordIndex;</div>
<div class="line">};</div>
</div><!-- fragment --> 
</div>
</div>
<a id="ac5eef073896dd142c677b8413e603803" href=""></a><a id="type" href=""></a>
<h2 class="memtitle"><span class="permalink"><a href="#type">&#9670;&#160;</a></span>Type()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static const <a class="elRef" target="_blank" href="https://apireference.codeporting.com/native/cs2cpp/class/system.type_info/">System::TypeInfo</a>&amp; Aspose::Words::MailMerging::IMailMergeDataSource::Type </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespace_aspose.html">Aspose</a></li><li class="navelem"><a class="el" href="namespace_aspose_1_1_words.html">Words</a></li><li class="navelem"><a class="el" href="namespace_aspose_1_1_words_1_1_mail_merging.html">MailMerging</a></li><li class="navelem"><a class="el" href="class_aspose_1_1_words_1_1_mail_merging_1_1_i_mail_merge_data_source.html">IMailMergeDataSource</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
